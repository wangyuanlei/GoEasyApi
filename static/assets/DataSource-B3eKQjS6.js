import{s as f,d as C,r as g,w as S,o as z,c as B,a as U,b as E,e as l,f as u,g as I,h as q,i as b,j as s,k as m,t as L,E as j,_ as A}from"./index-IYHzICXp.js";class y{static getDatas(d){return f({url:"/manger/db/get_conf",method:"get",headers:{token:d}})}static saveData(d,t){const o=new FormData;return o.append("name",t.DatabaseName),o.append("description",t.Description),o.append("orm_type",t.OrmType),o.append("dns",t.Dns),f({url:"/manger/db/set_conf",method:"post",data:o,headers:{token:d}})}}const M={class:"dataSource-box"},F={class:"btn-box"},p="110px",P=C({__name:"DataSource",setup(k){const d=localStorage.getItem("accessToken"),t=g(!1),o={DatabaseName:"",Description:"",OrmType:"",Dns:"",DemoDns:""},e=g({DatabaseName:"",Description:"",OrmType:"",Dns:"",DemoDns:""}),w={DatabaseName:[{required:!0,message:"请输入数据库名称",trigger:"blur"}],Description:[{required:!0,message:"请输入描述",trigger:"blur"}],OrmType:[{required:!0,message:"请输入数据库类型",trigger:"blur"}],Dns:[{required:!0,message:"请输入链接地址",trigger:"blur"}]},T=()=>{switch(e.value={...o},e.value.OrmType){case"mysql":e.value.DemoDns="username:password@tcp(localhost:3306)/dbname?charset=utf8mb4&parseTime=True&loc=Local";break;case"postgresql":e.value.DemoDns="host=localhost user=your_username password=your_password dbname=your_db port=5432 sslmode=disable";break;case"sqlserver":e.value.DemoDns="sqlserver://username:password@localhost:1433?database=dbname";break;case"sqlite":e.value.DemoDns="./db.sql";break}};S(()=>e.value.OrmType,r=>{r==="mysql"?e.value.DemoDns="username:password@tcp(localhost:3306)/dbname?charset=utf8mb4&parseTime=True&loc=Local":r==="postgresql"?e.value.DemoDns="host=localhost user=your_username password=your_password dbname=your_db port=5432 sslmode=disable":r==="sqlserver"?e.value.DemoDns="sqlserver://username:password@localhost:1433?database=dbname":r==="sqlite"&&(e.value.DemoDns="./db.sql")});const V=()=>{y.saveData(d,e.value).then(()=>{j.success("保存成功"),v()})};z(()=>{v()});const v=()=>{t.value=!0,y.getDatas(d).then(r=>{t.value=!1,Object.assign(o,r.data),e.value={...r.data}})};return(r,a)=>{const D=u("el-input"),i=u("el-form-item"),c=u("el-radio"),h=u("el-radio-group"),N=u("el-form"),_=u("el-button"),O=u("el-card"),x=I("loading");return q(),B("div",M,[U((q(),E(O,{class:"custom-card"},{default:l(()=>[a[10]||(a[10]=b("div",{class:"card-header"},[b("span",null,"数据源")],-1)),s(N,{model:e.value,rules:w,ref:"formRef1"},{default:l(()=>[s(i,{label:"数据库名称","label-width":p,prop:"DatabaseName"},{default:l(()=>[s(D,{modelValue:e.value.DatabaseName,"onUpdate:modelValue":a[0]||(a[0]=n=>e.value.DatabaseName=n),size:"large",clearable:""},null,8,["modelValue"])]),_:1}),s(i,{label:"描述","label-width":p,prop:"Description"},{default:l(()=>[s(D,{modelValue:e.value.Description,"onUpdate:modelValue":a[1]||(a[1]=n=>e.value.Description=n),size:"large",clearable:""},null,8,["modelValue"])]),_:1}),s(i,{label:"数据库类型",prop:"OrmType","label-width":p,required:""},{default:l(()=>[s(h,{modelValue:e.value.OrmType,"onUpdate:modelValue":a[2]||(a[2]=n=>e.value.OrmType=n)},{default:l(()=>[s(c,{label:"mysql"},{default:l(()=>a[4]||(a[4]=[m("mysql")])),_:1}),s(c,{label:"postgresql"},{default:l(()=>a[5]||(a[5]=[m("postgresql")])),_:1}),s(c,{label:"sqlserver"},{default:l(()=>a[6]||(a[6]=[m("sqlserver")])),_:1}),s(c,{label:"sqlite"},{default:l(()=>a[7]||(a[7]=[m("sqlite")])),_:1})]),_:1},8,["modelValue"])]),_:1}),s(i,{label:"链接地址","label-width":p,prop:"Dns"},{default:l(()=>[s(D,{modelValue:e.value.Dns,"onUpdate:modelValue":a[3]||(a[3]=n=>e.value.Dns=n),size:"large",clearable:""},null,8,["modelValue"])]),_:1}),s(i,{label:"参考值","label-width":p},{default:l(()=>[b("span",null,L(e.value.DemoDns),1)]),_:1})]),_:1},8,["model"]),b("div",F,[s(_,{size:"large",onClick:T},{default:l(()=>a[8]||(a[8]=[m("设为默认值")])),_:1}),s(_,{size:"large",type:"primary",onClick:V},{default:l(()=>a[9]||(a[9]=[m("保存")])),_:1})])]),_:1})),[[x,t.value]])])}}}),W=A(P,[["__scopeId","data-v-38b324a6"]]);export{W as default};
