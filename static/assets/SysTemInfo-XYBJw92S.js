import{d as R,r as p,w as j,o as G,E as i,c as H,i as v,j as l,e as o,b as y,v as B,a as J,F as K,f as s,g as O,h as _,k as d,u as Q,q as X,x as L,_ as Y}from"./index-IYHzICXp.js";import{A as c}from"./sysSet-wBOej0fK.js";const Z={class:"overall-plugin-table"},ee={class:"overall-plugin-top"},te={class:"search-left"},le={class:"search-right"},oe={class:"overall-plugin-bottom"},ae={class:"dialog-footer"},q="110px",ne=R({__name:"SysTemInfo",setup(se){const b=p(!1),u=localStorage.getItem("accessToken"),k=p([]),n=p(0),V=p(""),m=p(!1);j(n,t=>{f(t)});const f=t=>{b.value=!0,c.SetType(u,t.toString()).then(()=>{}).catch(e=>{console.log("err",e)}),t===1?c.getBlackList(u).then(e=>{b.value=!1,k.value=e.data}):t===2?c.getWhiteList(u).then(e=>{b.value=!1,k.value=e.data}):(b.value=!1,k.value=[])};G(()=>{c.getType(u).then(t=>{n.value=t.data,t.data==1?n.value=1:t.data==2&&(n.value=2),f(t.data)}).catch(t=>{console.log("err",t),i({message:"初始值获取失败",type:"error"})})});const D=t=>{n.value===1?L.confirm("此操作将永久该黑名单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c.deleteBlack(u,t.IP).then(()=>{i({message:"删除成功",type:"success"}),f(1)}).catch(e=>{console.log("err",e),i({message:"删除失败",type:"error"})})}):L.confirm("此操作将永久删除该白名单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c.deleteWhite(u,t.IP).then(()=>{i({message:"删除成功",type:"success"}),f(2)}).catch(e=>{console.log("err",e),i({message:"删除失败",type:"error"})})})},w=p(),r=p({ip:"",description:""}),C=()=>{r.value={ip:"",description:""},w.value&&w.value.clearValidate(),V.value=""},E={ip:[{required:!0,message:"请输入ip",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}]},F=()=>{c.addBlack(u,r.value).then(()=>{i({message:"添加成功",type:"success"}),m.value=!1,f(1)}).catch(t=>{console.log("err",t),i({message:"添加失败",type:"error"})})},N=()=>{if(!r.value.ip||!r.value.description){i({message:"请输入完整信息",type:"warning"});return}c.addWhite(u,r.value).then(()=>{i({message:"添加成功",type:"success"}),f(2),C(),m.value=!1}).catch(t=>{console.log("err",t),i({message:"添加失败",type:"error"})})},I=t=>{m.value=!0,V.value=t==="black"?"添加黑名单":"添加白名单"};return(t,e)=>{const x=s("el-radio"),P=s("el-radio-group"),T=s("el-form-item"),g=s("el-button"),h=s("el-table-column"),U=s("el-tooltip"),W=s("el-button-group"),$=s("el-table"),S=s("el-input"),z=s("el-form"),A=s("el-dialog"),M=O("loading");return _(),H(K,null,[v("div",Z,[v("div",ee,[v("div",te,[l(T,{label:"名单类型:"},{default:o(()=>[l(P,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=a=>n.value=a)},{default:o(()=>[l(x,{label:0},{default:o(()=>e[7]||(e[7]=[d("无")])),_:1}),l(x,{label:1},{default:o(()=>e[8]||(e[8]=[d("黑名单")])),_:1}),l(x,{label:2},{default:o(()=>e[9]||(e[9]=[d("白名单")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),v("div",le,[n.value===1?(_(),y(g,{key:0,type:"primary",onClick:e[1]||(e[1]=a=>I("black")),size:"large"},{default:o(()=>e[10]||(e[10]=[d("+ 添加黑名单")])),_:1})):B("",!0),n.value===2?(_(),y(g,{key:1,type:"primary",onClick:e[2]||(e[2]=a=>I("white")),size:"large"},{default:o(()=>e[11]||(e[11]=[d("+ 添加白名单")])),_:1})):B("",!0)])]),v("div",oe,[J((_(),y($,{data:k.value,style:{width:"100%",height:"100%"},border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#909399"},"empty-text":"没有数据"},{default:o(()=>[l(h,{type:"index",label:"序号","min-width":"30",align:"center","header-align":"center"}),l(h,{prop:"IP",label:"Ip","header-align":"center"}),l(h,{prop:"Description",label:"描述","show-overflow-tooltip":"","header-align":"center"}),l(h,{label:"操作","header-align":"center",align:"center"},{default:o(a=>[l(W,null,{default:o(()=>[l(U,{class:"box-item",effect:"dark",content:"删除",placement:"top"},{default:o(()=>[l(g,{type:"danger",icon:Q(X),size:"small",onClick:re=>D(a.row)},null,8,["icon","onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[M,b.value]])])]),l(A,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=a=>m.value=a),title:V.value,width:"500",onClose:C},{footer:o(()=>[v("div",ae,[l(g,{onClick:e[5]||(e[5]=a=>m.value=!1)},{default:o(()=>e[12]||(e[12]=[d("取消")])),_:1}),n.value===1?(_(),y(g,{key:0,type:"primary",onClick:F},{default:o(()=>e[13]||(e[13]=[d(" 确定 ")])),_:1})):n.value===2?(_(),y(g,{key:1,type:"primary",onClick:N},{default:o(()=>e[14]||(e[14]=[d(" 确定 ")])),_:1})):B("",!0)])]),default:o(()=>[l(z,{model:r.value,rules:E,ref_key:"formRef",ref:w},{default:o(()=>[l(T,{label:"ip",prop:"ip","label-width":q,required:""},{default:o(()=>[l(S,{modelValue:r.value.ip,"onUpdate:modelValue":e[3]||(e[3]=a=>r.value.ip=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(T,{label:"description",prop:"description","label-width":q,required:""},{default:o(()=>[l(S,{modelValue:r.value.description,"onUpdate:modelValue":e[4]||(e[4]=a=>r.value.description=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}}),de=Y(ne,[["__scopeId","data-v-e4e3c3f5"]]);export{de as default};
