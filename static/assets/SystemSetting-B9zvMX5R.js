import{A as p}from"./sysSet-wBOej0fK.js";import{d as G,r as v,w as H,o as J,E as i,c as w,i as o,a as K,j as a,e as l,b as h,v as B,F as S,f as u,g as O,h as m,k as f,y as Q,t as P,x as L,_ as X}from"./index-IYHzICXp.js";const Y={class:"w-full h-full bg-gray-100"},Z={class:"w-full h-full pt-10 sys-box"},ee={class:"center-box rounded m-auto p-5"},te={class:"info-reply-box"},le={class:"info-reply"},oe={style:{height:"90%"}},se={class:"card-left"},ae={class:"flex justify-between items-center"},ne={class:""},ie={class:"text-base"},re={class:"card-right ml-3"},de=["onClick"],ue={class:"btn-box"},ce={class:"dialog-footer"},q="110px",pe=G({__name:"SystemSetting",setup(me){const c=localStorage.getItem("accessToken"),g=v(!1),k=v(""),_=v(!1),x=v([]),r=v(0),y=t=>{_.value=!0,p.SetType(c,t.toString()).then(()=>{}).catch(e=>{console.log("err",e)}),t===1?p.getBlackList(c).then(e=>{x.value=e.data.map(d=>({IP:d.IP,Description:d.Description}))}).catch(()=>{_.value=!1}):t===2?p.getWhiteList(c).then(e=>{x.value=e.data.map(d=>({IP:d.IP,Description:d.Description}))}).catch(()=>{_.value=!1}):x.value=[]};H(r,t=>{y(t)}),J(()=>{p.getType(c).then(t=>{r.value=t.data}).catch(t=>{console.log("err",t),i({message:"初始值获取失败",type:"error"})})});const C=t=>{g.value=!0,k.value=t==="black"?"添加黑名单":"添加白名单"},E=t=>{r.value===1?L.confirm("此操作将永久该黑名单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{p.deleteBlack(c,t.IP).then(()=>{i({message:"删除成功",type:"success"}),y(1)}).catch(e=>{console.log("err",e),i({message:"删除失败",type:"error"})})}):L.confirm("此操作将永久删除该白名单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{p.deleteWhite(c,t.IP).then(()=>{i({message:"删除成功",type:"success"}),y(2)}).catch(e=>{console.log("err",e),i({message:"删除失败",type:"error"})})})},n=v({ip:"",description:""}),V=v(),I=()=>{n.value={ip:"",description:""},V.value&&V.value.clearValidate(),k.value=""},F={ip:[{required:!0,message:"请输入ip",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}]},N=()=>{p.addBlack(c,n.value).then(()=>{i({message:"添加成功",type:"success"}),g.value=!1,y(1)}).catch(t=>{console.log("err",t),i({message:"添加失败",type:"error"})}).catch(()=>{_.value=!1})},U=()=>{if(!n.value.ip||!n.value.description){i({message:"请输入完整信息",type:"warning"});return}p.addWhite(c,n.value).then(()=>{i({message:"添加成功",type:"success"}),y(2),I(),g.value=!1}).catch(t=>{console.log("err",t),i({message:"添加失败",type:"error"})}).catch(()=>{_.value=!1})};return(t,e)=>{const d=u("el-radio"),W=u("el-radio-group"),$=u("el-card"),A=u("el-scrollbar"),b=u("el-button"),T=u("el-input"),D=u("el-form-item"),M=u("el-form"),j=u("el-dialog"),R=O("loading");return m(),w(S,null,[o("div",Y,[o("div",Z,[o("section",ee,[e[12]||(e[12]=o("div",{class:"head-title text-2xl text-center pb-6 font-light"},"系统设置",-1)),e[13]||(e[13]=o("div",{class:"dashed px-8"},null,-1)),K((m(),w("div",te,[a(A,{"max-height":"505"},{default:l(()=>[o("div",le,[a(W,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s)},{default:l(()=>[a(d,{label:0},{default:l(()=>e[7]||(e[7]=[f("无")])),_:1}),a(d,{label:1},{default:l(()=>e[8]||(e[8]=[f("黑名单")])),_:1}),a(d,{label:2},{default:l(()=>e[9]||(e[9]=[f("白名单")])),_:1})]),_:1},8,["modelValue"])]),o("div",oe,[(m(!0),w(S,null,Q(x.value,(s,z)=>(m(),h($,{class:"w-full mb-4",key:z},{default:l(()=>[o("div",se,[o("div",ae,[o("div",ne,"IP:"+P(s.IP),1),o("div",ie,"描述："+P(s.Description),1)])]),o("div",re,[o("i",{class:"iconfont icon-htmal5icon17 text-2xl text-red-500 cursor-pointer",onClick:fe=>E(s)},null,8,de)])]),_:2},1024))),128))])]),_:1})])),[[R,_.value]]),o("div",ue,[r.value===1?(m(),h(b,{key:0,type:"primary",onClick:e[1]||(e[1]=s=>C("black"))},{default:l(()=>e[10]||(e[10]=[f("添加黑名单")])),_:1})):B("",!0),r.value===2?(m(),h(b,{key:1,type:"primary",onClick:e[2]||(e[2]=s=>C("white"))},{default:l(()=>e[11]||(e[11]=[f("添加白名单")])),_:1})):B("",!0)])])])]),a(j,{modelValue:g.value,"onUpdate:modelValue":e[6]||(e[6]=s=>g.value=s),title:k.value,width:"500",onClose:I},{footer:l(()=>[o("div",ce,[a(b,{onClick:e[5]||(e[5]=s=>g.value=!1)},{default:l(()=>e[14]||(e[14]=[f("取消")])),_:1}),r.value===1?(m(),h(b,{key:0,type:"primary",onClick:N},{default:l(()=>e[15]||(e[15]=[f(" 确定 ")])),_:1})):r.value===2?(m(),h(b,{key:1,type:"primary",onClick:U},{default:l(()=>e[16]||(e[16]=[f(" 确定 ")])),_:1})):B("",!0)])]),default:l(()=>[a(M,{model:n.value,rules:F,ref_key:"formRef",ref:V},{default:l(()=>[a(D,{label:"ip",prop:"ip","label-width":q,required:""},{default:l(()=>[a(T,{modelValue:n.value.ip,"onUpdate:modelValue":e[3]||(e[3]=s=>n.value.ip=s),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(D,{label:"description",prop:"description","label-width":q,required:""},{default:l(()=>[a(T,{modelValue:n.value.description,"onUpdate:modelValue":e[4]||(e[4]=s=>n.value.description=s),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}}),_e=X(pe,[["__scopeId","data-v-0d523705"]]);export{_e as default};
